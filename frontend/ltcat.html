<!doctype html>
<html lang="pt-BR">
 <style>
  .actions-cell {
    display: flex;
    gap: 4px;
    justify-content: center;
  }

  .icon-btn {
    border: none;
    background: #e5f0ff;
    border-radius: 6px;
    padding: 2px 6px;
    cursor: pointer;
    font-size: 12px;
    line-height: 1;
    transition: background 0.15s, transform 0.05s;
  }

  .icon-btn:hover {
    background: #d0e3ff;
    transform: translateY(-1px);
  }

  .icon-btn.delete {
    background: #ffe4e1;
  }

  .icon-btn.delete:hover {
    background: #ffc9c4;
  }
</style>
 
<head>
  <meta charset="utf-8">
  <title>DataInsight SST ‚Äì LTCAT / Laudo T√©cnico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="assets/branding.css">

  <!-- Biblioteca para gerar PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <style>
    .actions-cell {
      display: flex;
      gap: 4px;
      justify-content: center;
    }
    .icon-btn {
      border: none;
      background: #e5f0ff;
      border-radius: 6px;
      padding: 2px 6px;
      cursor: pointer;
      font-size: 12px;
      line-height: 1;
      transition: background 0.15s, transform 0.05s;
    }
    .icon-btn:hover {
      background: #d0e3ff;
      transform: translateY(-1px);
    }
    .icon-btn.delete {
      background: #ffe4e1;
    }
    .icon-btn.delete:hover {
      background: #ffc9c4;
    }
  </style>

  <script src="ltcat.js" defer></script>
</head>

<body>

<nav class="nav">
  <div class="wrap">
    <div class="logo">
      <img src="assets/datainsight.jpg" alt="Logo">
      <span>LTCAT ‚Äî Laudo T√©cnico de Condi√ß√µes Ambientais</span>
    </div>

    <div style="margin-left:auto; display:flex; gap:8px;">
      <a class="btn secondary" href="dashboard.html">üè† Dashboard</a>
      <a class="btn secondary" href="pgr.html">üìù PGR / NR-01</a>
      <a class="btn secondary" href="pcmso.html">‚öïÔ∏è PCMSO / ASO</a>
      <a class="btn secondary" href="nr17.html">ü™ë NR-17</a>
      <a class="btn active" href="ltcat.html">üìÑ LTCAT</a>
      <button onclick="logout()" class="btn danger">Sair</button>
    </div>
  </div>
</nav>

<div class="container">

  <!-- FORMUL√ÅRIO LTCAT -->
  <div class="card">
    <h2>üìÑ Registro de Informa√ß√µes para LTCAT</h2>
    <p class="section-subtitle">
      Estruture as informa√ß√µes essenciais para elabora√ß√£o do LTCAT: agente nocivo, exposi√ß√£o e enquadramento previdenci√°rio.
    </p>

    <div class="form-grid mt-3">

      <label>Empresa
        <input type="text" id="empresa" placeholder="Ex: Metal√∫rgica Alfa LTDA">
      </label>

      <label>CNPJ
        <input type="text" id="cnpj" placeholder="00.000.000/0000-00">
      </label>

      <label>Setor
        <input type="text" id="setor" placeholder="Ex: Caldeiraria / Oficina / Escrit√≥rio">
      </label>

      <label>Fun√ß√£o
        <input type="text" id="funcao" placeholder="Ex: Soldador / Operador de Prensa">
      </label>

      <label>GHE (opcional)
        <input type="text" id="ghe" placeholder="Ex: GHE 01 ‚Äì Soldagem">
      </label>

      <label>Agente Nocivo
        <input type="text" id="agente" placeholder="Ex: Ru√≠do, Benzeno, Calor, S√≠lica...">
      </label>

      <label>Classifica√ß√£o do Agente
        <select id="classificacao">
          <option value="F√≠sico">F√≠sico</option>
          <option value="Qu√≠mico">Qu√≠mico</option>
          <option value="Biol√≥gico">Biol√≥gico</option>
          <option value="Misto">Misto</option>
        </select>
      </label>

      <label>Fonte Geradora
        <input type="text" id="fonte" placeholder="Ex: Prensa hidr√°ulica, forno, produto qu√≠mico...">
      </label>

      <label>Meio de Propaga√ß√£o
        <input type="text" id="meio" placeholder="Ex: Ar, contato direto, superf√≠cies...">
      </label>

      <label>Intensidade / Concentra√ß√£o
        <input type="text" id="intensidade" placeholder="Ex: 92 dB(A), 15 ppm, 28 ¬∫C IBUTG">
      </label>

      <label>Unidade
        <input type="text" id="unidade" placeholder="Ex: dB(A), ppm, ¬∫C, mg/m¬≥">
      </label>

      <label>Jornada di√°ria (h)
        <input type="number" id="jornada" min="0" step="0.25" placeholder="Ex: 8">
      </label>

      <label>Dias por semana
        <input type="number" id="diasSemana" min="1" max="7" placeholder="Ex: 5">
      </label>

      <label>Tempo de exposi√ß√£o (anos)
        <input type="number" id="tempoAnos" min="0" step="0.5" placeholder="Ex: 12">
      </label>

      <label>EPC / EPI eficaz?
        <select id="epiEficaz">
          <option value="Sim">Sim</option>
          <option value="N√£o">N√£o</option>
          <option value="Parcial">Parcial</option>
        </select>
      </label>

      <label>Enquadramento Previdenci√°rio
        <select id="enquadramento">
          <option value="Sem enquadramento">Sem enquadramento</option>
          <option value="Especial ‚Äì 15 anos">Especial ‚Äì 15 anos</option>
          <option value="Especial ‚Äì 20 anos">Especial ‚Äì 20 anos</option>
          <option value="Especial ‚Äì 25 anos">Especial ‚Äì 25 anos</option>
        </select>
      </label>

      <label>Data da Avalia√ß√£o / Medi√ß√£o
        <input type="date" id="data">
      </label>

      <label>Respons√°vel T√©cnico
        <input type="text" id="responsavel" placeholder="Nome / Registro profissional">
      </label>

      <label style="grid-column: 1 / -1;">Observa√ß√µes (opcional)
        <textarea id="observacoes" rows="3" placeholder="Descrever metodologia utilizada, normas t√©cnicas, condi√ß√µes at√≠picas, recomenda√ß√µes..."></textarea>
      </label>

    </div>

    <div class="actions-row">
      <button id="btn-salvar-ltcat" class="btn primary" onclick="salvarLTCAT()">üíæ Salvar Registro</button>
      <button class="btn secondary" onclick="limparLTCAT()">üßπ Limpar</button>
      <button class="btn secondary" onclick="imprimirUltimoLTCAT()">üñ®Ô∏è Imprimir √∫ltimo</button>
      <button class="btn secondary" onclick="exportarPDFUltimoLTCAT()">üìÑ Exportar PDF (√∫ltimo)</button>
    </div>
  </div>

  <!-- LISTA DE REGISTROS -->
  <div class="card">
    <h2>üìö Registros para LTCAT</h2>

    <div class="actions-row">
      <input
        type="text"
        id="filtroLTCAT"
        placeholder="Filtrar por empresa, setor, fun√ß√£o ou agente..."
        oninput="filtrarLTCAT()"
        style="flex:1; max-width:360px;"
      >
    </div>

    <table class="table" id="tabelaLTCAT">
      <thead>
        <tr>
          <th>Data</th>
          <th>Empresa</th>
          <th>Setor</th>
          <th>Fun√ß√£o</th>
          <th>Agente</th>
          <th>Classifica√ß√£o</th>
          <th>Enquadramento</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- √ÅREA OCULTA PARA RELAT√ìRIO PDF -->
  <div id="areaRelatorioLTCAT" style="display:none;">
    <div id="conteudoRelatorioLTCAT" style="padding:20px; font-family:system-ui;"></div>
  </div>

</div>

<script>
function logout() {
  localStorage.clear();
  window.location.href = "index.html";
}
</script>

</body>
</html>
