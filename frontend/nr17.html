<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>DataInsight SST â€“ NR-17 / AvaliaÃ§Ã£o ErgonÃ´mica</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="assets/branding.css">

  <!-- Biblioteca para gerar PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <script src="nr17.js" defer></script>
</head>

<body>

<nav class="nav">
  <div class="wrap">
    <div class="logo">
      <img src="assets/datainsight.jpg" alt="Logo">
      <span>NR-17 â€” AvaliaÃ§Ã£o ErgonÃ´mica</span>
    </div>

    <div style="margin-left:auto; display:flex; gap:8px;">
      <a class="btn secondary" href="dashboard.html">ğŸ  Dashboard</a>
      <a class="btn secondary" href="pgr.html">ğŸ“ PGR / NR-01</a>
      <a class="btn secondary" href="pcmso.html">âš•ï¸ PCMSO / ASO</a>
      <a class="btn active" href="nr17.html">ğŸª‘ NR-17</a>
      <a class="btn secondary" href="ltcat.html">ğŸ“„ LTCAT</a>
      <button onclick="logout()" class="btn danger">Sair</button>
    </div>
  </div>
</nav>

<div class="container">

  <!-- CARD PRINCIPAL â€“ FORMULÃRIO -->
  <div class="card">
    <h2>ğŸª‘ NR-17 â€” AvaliaÃ§Ã£o ErgonÃ´mica de Posto de Trabalho</h2>
    <p class="section-subtitle">
      Registre as condiÃ§Ãµes ergonÃ´micas do posto e obtenha uma classificaÃ§Ã£o simples de risco.
    </p>

    <div class="form-grid mt-3">

      <label>Empresa (opcional)
        <input type="text" id="empresa" placeholder="Ex: MetalÃºrgica Alfa LTDA">
      </label>

      <label>Setor
        <input type="text" id="setor" placeholder="Ex: Administrativo / ProduÃ§Ã£o">
      </label>

      <label>FunÃ§Ã£o Avaliada
        <input type="text" id="funcao" placeholder="Ex: Operador de MÃ¡quina / Digitador">
      </label>

      <label>Trabalhador (opcional)
        <input type="text" id="trabalhador" placeholder="Nome ou cÃ³digo">
      </label>

      <label>Tipo de Posto
        <select id="tipoPosto">
          <option value="Administrativo">Administrativo</option>
          <option value="ProduÃ§Ã£o">ProduÃ§Ã£o</option>
          <option value="Atendimento">Atendimento</option>
          <option value="Outro">Outro</option>
        </select>
      </label>

      <label>Data da AvaliaÃ§Ã£o
        <input type="date" id="dataAvaliacao">
      </label>

      <label>MobiliÃ¡rio / Ajustes
        <select id="mobiliario" onchange="calcularIndiceNR17()">
          <option value="1">Adequado (ajustes suficientes)</option>
          <option value="2">Parcialmente adequado</option>
          <option value="3">Inadequado / sem ajustes</option>
        </select>
      </label>

      <label>Posturas de Trabalho
        <select id="postura" onchange="calcularIndiceNR17()">
          <option value="1">ConfortÃ¡vel / poucas queixas</option>
          <option value="2">Algum desconforto / posturas mantidas</option>
          <option value="3">Posturas forÃ§adas / queixas frequentes</option>
        </select>
      </label>

      <label>EsforÃ§o FÃ­sico / Carga
        <select id="esforco" onchange="calcularIndiceNR17()">
          <option value="1">EsforÃ§o leve</option>
          <option value="2">EsforÃ§o moderado</option>
          <option value="3">EsforÃ§o intenso / repetitivo</option>
        </select>
      </label>

      <label>Pausas / Ritmo de Trabalho
        <select id="pausas" onchange="calcularIndiceNR17()">
          <option value="1">Pausas adequadas</option>
          <option value="2">Pausas insuficientes</option>
          <option value="3">Sem pausas / ritmo elevado</option>
        </select>
      </label>

      <label>Ambiente FÃ­sico (iluminaÃ§Ã£o, ruÃ­do, temperatura)
        <select id="ambiente" onchange="calcularIndiceNR17()">
          <option value="1">CondiÃ§Ãµes adequadas</option>
          <option value="2">Alguns incÃ´modos</option>
          <option value="3">CondiÃ§Ãµes desfavorÃ¡veis</option>
        </select>
      </label>

      <label>OrganizaÃ§Ã£o do Trabalho / ExigÃªncias cognitivas
        <select id="organizacao" onchange="calcularIndiceNR17()">
          <option value="1">Organizado, demandas claras</option>
          <option value="2">Alguma pressÃ£o / demandas pouco claras</option>
          <option value="3">Alta pressÃ£o / demandas conflitantes</option>
        </select>
      </label>

      <label style="grid-column: 1 / -1;">ObservaÃ§Ãµes (opcional)
        <textarea id="observacoes" rows="3" placeholder="Descreva situaÃ§Ãµes crÃ­ticas, queixas, sugestÃµes de melhoria..."></textarea>
      </label>

    </div>

    <div class="actions-row">
      <span class="section-subtitle">
        Ãndice global de risco:
        <strong id="resultadoRisco">â€“</strong>
      </span>
    </div>

    <div class="actions-row">
      <button class="btn primary" onclick="salvarNR17()">ğŸ’¾ Salvar AvaliaÃ§Ã£o</button>
      <button class="btn secondary" onclick="limparNR17()">ğŸ§¹ Limpar</button>
      <button class="btn secondary" onclick="imprimirUltimaNR17()">ğŸ–¨ï¸ Imprimir Ãºltima avaliaÃ§Ã£o</button>
      <button class="btn secondary" onclick="exportarPDFUltimaNR17()">ğŸ“„ Exportar PDF (Ãºltima)</button>
    </div>

  </div>

  <!-- CARD TABELA + FILTRO -->
  <div class="card">
    <h2>ğŸ“‹ AvaliaÃ§Ãµes Registradas â€” NR-17</h2>

    <div class="actions-row">
      <input
        type="text"
        id="filtroNR17"
        placeholder="Filtrar por setor, funÃ§Ã£o ou risco..."
        oninput="filtrarNR17()"
        style="flex:1; max-width:320px;"
      >
    </div>

    <table class="table" id="tabelaNR17">
      <thead>
        <tr>
          <th>Data</th>
          <th>Setor</th>
          <th>FunÃ§Ã£o</th>
          <th>Tipo de Posto</th>
          <th>ClassificaÃ§Ã£o de Risco</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- ÃREA OCULTA PARA GERAR PDF BONITINHO -->
  <div id="areaRelatorioNR17" style="display:none;">
    <div id="conteudoRelatorioNR17" style="padding:20px; font-family:system-ui;">
      <!-- O JS preenche isso aqui antes de gerar PDF -->
    </div>
  </div>

</div>

<script>
function logout() {
  localStorage.clear();
  window.location.href = "index.html";
}
</script>

</body>
</html>
